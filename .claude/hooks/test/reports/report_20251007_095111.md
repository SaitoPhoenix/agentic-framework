# Hook Test Report

**Generated:** 2025-10-07 09:51:11

**Total Tests:** 60 | **Passed:** 13 | **Failed:** 47 | **Errors:** 0 | **Pass Rate:** 21.7%

## Summary by Category

| Category | Tests | Passed | Failed | Errors | Pass Rate |
|----------|-------|--------|--------|--------|-----------|
| edge_cases | 12 | 3 | 9 | 0 | 25.0% |
| future | 11 | 0 | 11 | 0 | 0.0% |
| security_allow | 4 | 3 | 1 | 0 | 75.0% |
| security_ask | 10 | 2 | 8 | 0 | 20.0% |
| security_deny | 20 | 2 | 18 | 0 | 10.0% |
| uncategorized | 3 | 3 | 0 | 0 | 100.0% |

## Failed Tests

### ❌ ask_api_key_file
- **Category:** security_ask
- **Priority:** high
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "ask",
    "actual": "ask",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "API key.*sensitive"
    },
    "actual": "API key file detected. Proceed with caution?",
    "matched": false
  }
}
  ```

### ❌ ask_git_push_-f
- **Category:** security_ask
- **Priority:** high
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "ask",
    "actual": "ask",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "contains": "force push"
    },
    "actual": "Force push detected. This will overwrite remote history. Continue?",
    "matched": false
  }
}
  ```

### ❌ ask_curl_pipe_bash
- **Category:** security_ask
- **Priority:** high
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "ask",
    "actual": "ask",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "contains": "piping to shell"
    },
    "actual": "Piping curl to shell can be dangerous. Proceed?",
    "matched": false
  }
}
  ```

### ❌ ask_git_push_force
- **Category:** security_ask
- **Priority:** high
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "ask",
    "actual": "ask",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "contains": "force push"
    },
    "actual": "Force push detected. This will overwrite remote history. Continue?",
    "matched": false
  }
}
  ```

### ❌ ask_wget_pipe_sh
- **Category:** security_ask
- **Priority:** high
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "ask",
    "actual": "ask",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "contains": "piping to shell"
    },
    "actual": "Piping wget to shell can be dangerous. Proceed?",
    "matched": false
  }
}
  ```

### ❌ ask_wget_pipe_bash
- **Category:** security_ask
- **Priority:** high
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "ask",
    "actual": "ask",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "contains": "piping to shell"
    },
    "actual": "Piping wget to shell can be dangerous. Proceed?",
    "matched": false
  }
}
  ```

### ❌ ask_curl_pipe_sh
- **Category:** security_ask
- **Priority:** high
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "ask",
    "actual": "ask",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "contains": "piping to shell"
    },
    "actual": "Piping curl to shell can be dangerous. Proceed?",
    "matched": false
  }
}
  ```

### ❌ ask_token_file
- **Category:** security_ask
- **Priority:** high
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "ask",
    "actual": "ask",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "token.*sensitive"
    },
    "actual": "Token file detected. Are you sure?",
    "matched": false
  }
}
  ```

### ❌ deny_key_file
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Access to.*\\.key files.*prohibited"
    },
    "actual": "Private key file access is blocked",
    "matched": false
  }
}
  ```

### ❌ deny_aws_credentials
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Access to AWS credentials.*prohibited"
    },
    "actual": "AWS credentials access is blocked",
    "matched": false
  }
}
  ```

### ❌ deny_credentials_json
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Access to.*credentials.*prohibited"
    },
    "actual": "Credentials file access is blocked",
    "matched": false
  }
}
  ```

### ❌ deny_aws_config
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Access to AWS.*prohibited"
    },
    "actual": "AWS config access is blocked",
    "matched": false
  }
}
  ```

### ❌ deny_rm_-fr_home
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Destructive rm command.*prohibited"
    },
    "actual": "Dangerous rm command with recursive force flags prevented for safety",
    "matched": false
  }
}
  ```

### ❌ deny_pem_file
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Access to.*\\.pem files.*prohibited"
    },
    "actual": "PEM certificate file access is blocked",
    "matched": false
  }
}
  ```

### ❌ deny_rm_-rf_dot
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Destructive rm command.*prohibited"
    },
    "actual": "Dangerous rm command with recursive force flags prevented for safety",
    "matched": false
  }
}
  ```

### ❌ deny_rm_-fR_wildcard
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Destructive rm command.*prohibited"
    },
    "actual": "Dangerous rm command with recursive force flags prevented for safety",
    "matched": false
  }
}
  ```

### ❌ deny_rm_-rf_slash
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Destructive rm command.*prohibited"
    },
    "actual": "Dangerous rm command with recursive force flags prevented for safety",
    "matched": false
  }
}
  ```

### ❌ deny_rm_-Rf_tilde
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Destructive rm command.*prohibited"
    },
    "actual": "Dangerous rm command with recursive force flags prevented for safety",
    "matched": false
  }
}
  ```

### ❌ deny_rm_recursive_force
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Destructive rm command.*prohibited"
    },
    "actual": "Dangerous rm command prevented for safety",
    "matched": false
  }
}
  ```

### ❌ deny_rm_force_recursive
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Destructive rm command.*prohibited"
    },
    "actual": "Dangerous rm command prevented for safety",
    "matched": false
  }
}
  ```

### ❌ deny_secrets_json
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Access to.*secrets.*prohibited"
    },
    "actual": "Secrets file access is blocked",
    "matched": false
  }
}
  ```

### ❌ deny_ssh_id_rsa
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Access to SSH keys.*prohibited"
    },
    "actual": "SSH private key access is blocked",
    "matched": false
  }
}
  ```

### ❌ deny_ssh_id_ed25519
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Access to SSH keys.*prohibited"
    },
    "actual": "SSH private key access is blocked",
    "matched": false
  }
}
  ```

### ❌ deny_su_command
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "su command.*prohibited"
    },
    "actual": "su commands are not allowed for security",
    "matched": false
  }
}
  ```

### ❌ deny_secrets_yaml
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Access to.*secrets.*prohibited"
    },
    "actual": "Secrets file access is blocked",
    "matched": false
  }
}
  ```

### ❌ deny_sudo_command
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "sudo command.*prohibited"
    },
    "actual": "sudo commands are not allowed for security",
    "matched": false
  }
}
  ```

### ❌ edge_chained_commands
- **Category:** edge_cases
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ edge_curl_multiline
- **Category:** edge_cases
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "ask",
    "actual": "ask",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "contains": "piping to shell"
    },
    "actual": "Piping curl to shell can be dangerous. Proceed?",
    "matched": false
  }
}
  ```

### ❌ edge_file_with_spaces
- **Category:** edge_cases
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ edge_env_uppercase
- **Category:** edge_cases
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ edge_rm_env_var
- **Category:** edge_cases
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ edge_rm_extra_spaces
- **Category:** edge_cases
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Destructive rm command.*prohibited"
    },
    "actual": "Dangerous rm command with recursive force flags prevented for safety",
    "matched": false
  }
}
  ```

### ❌ edge_rm_safe_specific
- **Category:** edge_cases
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_dd_command
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ edge_subshell_rm
- **Category:** edge_cases
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "allow",
    "matched": false
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Destructive rm command.*prohibited"
    },
    "actual": "Testing that echo command is whitelisted",
    "matched": false
  }
}
  ```

### ❌ edge_secrets_mixed_case
- **Category:** edge_cases
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_etc_shadow
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_etc_passwd
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_docker_config
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_git_credentials
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_mkfs_command
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_gpg_key
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_kube_config
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_pgpass
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_npmrc
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_netrc
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ whitelist_env_example
- **Category:** security_allow
- **Priority:** high
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "allow",
    "actual": "allow",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "contains": "example"
    },
    "actual": "Template files are safe to access",
    "matched": false
  }
}
  ```
