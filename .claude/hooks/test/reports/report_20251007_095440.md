# Hook Test Report

**Generated:** 2025-10-07 09:54:40

**Total Tests:** 57 | **Passed:** 30 | **Failed:** 27 | **Errors:** 0 | **Pass Rate:** 52.6%

## Summary by Category

| Category | Tests | Passed | Failed | Errors | Pass Rate |
|----------|-------|--------|--------|--------|-----------|
| edge_cases | 12 | 6 | 6 | 0 | 50.0% |
| future | 11 | 0 | 11 | 0 | 0.0% |
| security_allow | 4 | 2 | 2 | 0 | 50.0% |
| security_ask | 10 | 10 | 0 | 0 | 100.0% |
| security_deny | 20 | 12 | 8 | 0 | 60.0% |

## Failed Tests

### ❌ deny_credentials_json
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "credentials.*access is blocked"
    },
    "actual": "Credentials file access is blocked",
    "matched": false
  }
}
  ```

### ❌ deny_pem_file
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Private key file access is blocked"
    },
    "actual": "PEM certificate file access is blocked",
    "matched": false
  }
}
  ```

### ❌ deny_secrets_json
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "secrets.*access is blocked"
    },
    "actual": "Secrets file access is blocked",
    "matched": false
  }
}
  ```

### ❌ deny_secrets_yaml
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "secrets.*access is blocked"
    },
    "actual": "Secrets file access is blocked",
    "matched": false
  }
}
  ```

### ❌ deny_ssh_id_ed25519
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "SSH key.*access is blocked"
    },
    "actual": "SSH private key access is blocked",
    "matched": false
  }
}
  ```

### ❌ deny_sudo_command
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "sudo command is blocked"
    },
    "actual": "sudo commands are not allowed for security",
    "matched": false
  }
}
  ```

### ❌ deny_su_command
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "su command is blocked"
    },
    "actual": "su commands are not allowed for security",
    "matched": false
  }
}
  ```

### ❌ deny_ssh_id_rsa
- **Category:** security_deny
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "deny",
    "actual": "deny",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "SSH key.*access is blocked"
    },
    "actual": "SSH private key access is blocked",
    "matched": false
  }
}
  ```

### ❌ edge_file_with_spaces
- **Category:** edge_cases
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ edge_env_uppercase
- **Category:** edge_cases
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ edge_chained_commands
- **Category:** edge_cases
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ edge_rm_env_var
- **Category:** edge_cases
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ edge_rm_safe_specific
- **Category:** edge_cases
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ edge_secrets_mixed_case
- **Category:** edge_cases
- **Priority:** critical
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_dd_command
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_docker_config
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_etc_passwd
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_git_credentials
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_etc_shadow
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_gpg_key
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_kube_config
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_mkfs_command
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_pgpass
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ future_netrc
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```

### ❌ whitelist_env_sample
- **Category:** security_allow
- **Priority:** high
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "allow",
    "actual": "allow",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Template files are safe to access"
    },
    "actual": "Sensitive file access prevented for safety: .env.sample",
    "matched": false
  }
}
  ```

### ❌ whitelist_env_template
- **Category:** security_allow
- **Priority:** high
- **Hook Type:** PreToolUse
- **Error:** Validation failed
- **Details:**
  ```json
  {
  "hookSpecificOutput.permissionDecision": {
    "expected": "allow",
    "actual": "allow",
    "matched": true
  },
  "hookSpecificOutput.permissionDecisionReason": {
    "expected": {
      "regex": "Template files are safe to access"
    },
    "actual": "Sensitive file access prevented for safety: .env.template",
    "matched": false
  }
}
  ```

### ❌ future_npmrc
- **Category:** future
- **Priority:** low
- **Hook Type:** PreToolUse
- **Error:** No JSON output found
- **Details:**
  ```json
  {
  "parse_error": "No JSON output found in stdout or stderr"
}
  ```
